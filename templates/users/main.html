{% extends "base.html" %}
{% load static %}
{%block head%}
<link rel="stylesheet" href="{% static 'users/main.css' %}">
{% endblock %}

{% block content %}
    <div class="calendar-wrapper_psy">
        <div class="calendar_psy">

            <div class="month_psy">
                <span id="prevMonth_psy">&lt;</span>
                <h2 id="currentMonth_psy"></h2>
                <span id="nextMonth_psy">&gt;</span>
            </div>

            <div class="weekdays_psy">
                <div>Sun</div>
                <div>Mon</div>
                <div>Tue</div>
                <div>Wed</div>
                <div>Thu</div>
                <div>Fri</div>
                <div>Sat</div>
            </div>

            <div class="days_psy" id="days_psy"></div>
        </div>
    </div>

    <script>
        const currentMonthElement = document.getElementById("currentMonth_psy");
        const daysContainer = document.getElementById("days_psy");
        const prevMonthButton = document.getElementById("prevMonth_psy");
        const nextMonthButton = document.getElementById("nextMonth_psy");
        
        let currentDate = new Date();
        let selectedDate = null;
        
        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
        
            currentMonthElement.textContent = new Date(year, month).toLocaleString("en-US", { year: "numeric", month: "long" });
        
            const firstDayIndex = new Date(year, month, 1).getDay();
            const lastDate = new Date(year, month + 1, 0).getDate();
            const today = new Date();
        
            daysContainer.innerHTML = "";
        
            for (let i = 0; i < firstDayIndex; i++) {
                const emptyDiv = document.createElement("div");
                emptyDiv.classList.add("empty");
                daysContainer.appendChild(emptyDiv);
            }
        
            for (let day = 1; day <= lastDate; day++) {
                const dayElement = document.createElement("div");
                dayElement.classList.add("day_psy");
        
                const daySpan = document.createElement("span");
                daySpan.textContent = day;
                dayElement.appendChild(daySpan);
        
                const fullDate = new Date(year, month, day);
        
                if (
                    fullDate.getFullYear() === today.getFullYear() &&
                    fullDate.getMonth() === today.getMonth() &&
                    fullDate.getDate() === today.getDate()
                ) {
                    dayElement.classList.add("today");
                }
        
                if (fullDate < today) {
                    dayElement.classList.add("past");
                }
        
                dayElement.addEventListener("click", () => {
                    if (!dayElement.classList.contains("past")) {
                        if (selectedDate) {
                            selectedDate.classList.remove("selected");
                        }
                        dayElement.classList.add("selected");
                        selectedDate = dayElement;
                    }
                });
        
                daysContainer.appendChild(dayElement);
            }
        }
        
        prevMonthButton.addEventListener("click", () => {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        });
        
        nextMonthButton.addEventListener("click", () => {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        });
        
        renderCalendar();
    </script>

{% endblock %}
