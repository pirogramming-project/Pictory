{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'diaries/edit_diary.css' %}">
{% endblock %}

{% block content %}
<div class="create_diary_container_ksy">

    <div class="create_diary_left_container_psy">
        <img src="{% static 'images/pictory-frame2.png' %}" alt="인생네컷 사진">
    </div>

    <div class="create_diary_right_container_psy">
        <form class="create_diary_form_psy" method="post" action="{% url 'diaries:edit_diary' diary.id %}">
            {% csrf_token %}
            <div class="first_right_container_psy">
                <div class="first_line_psy">
                    <div class="diary_title_psy">
                        <h1 class="diary_letter_psy">o Title</h1>
                        {{ form.title }}
                    </div>
                    <div class="diary_emotion_psy">
                        <h1 class="diary_letter_psy">o Emotion</h1>
                        {{ form.emotion }}
                    </div>
                </div>

                <div class="second_line_psy">
                    <div class="diary_date_psy">
                        <h1 class="diary_letter_psy">o Date</h1>
                        {{ form.date }}
                    </div>
                    <div class="diary_weather_psy">
                        <h1 class="diary_letter_psy">o Weather</h1>
                        {{ form.weather }}
                    </div>
                </div>

                <div class="third_line_psy">

                    <div class="diary_tag_psy">
                        <div class="diary_content_tag_psy">
                            <h1 class="diary_letter_psy">o Tag</h1>
                            <input type="text" name="create_diary_post" placeholder="#으로 태그를 추가하세요" class="content_tag_psy" required>
                        </div>
                        <div class="diary_friend_psy">
                            <h1 class="diary_letter_psy">o Friend Tag</h1>
                                {% for checkbox in form.user_tags %}
                                    <div class="friend_tag_item_psy">
                                        {{ checkbox.tag }}
                                        <label for="{{ checkbox.id_for_label }}">{{ checkbox.choice_label }}</label>
                                    </div>
                                {% endfor %}
                        </div>
                    </div>

                    <div class="diary_map_psy">
                        <h1 class="diary_letter_psy">o Location</h1>
                        {{ form.place }}
                        <div class="real_location_psy"></div>
                    </div>

                </div>
            </div>
            
            <div class="fourth_line_psy">
                <h1 class="diary_letter_psy">o Content</h1>
                {{ form.content }}
            </div>

            <button type="submit" class="diary_save_psy">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"/>
                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"/>
                </svg>
            </button>
        </form>
        
    </div>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // 모든 친구 태그 요소를 가져옴
        let friendTags = document.querySelectorAll(".friend_tag_item_psy");

        friendTags.forEach(function(tagItem) {
            let checkbox = tagItem.querySelector("input[type='checkbox']");
            
            // 초기 상태 설정 (체크되었을 경우 색상 변경)
            if (checkbox.checked) {
                tagItem.classList.add("selected");
            }

            // 클릭 이벤트 추가
            tagItem.addEventListener("click", function() {
                checkbox.checked = !checkbox.checked; // 체크 상태 토글

                if (checkbox.checked) {
                    tagItem.classList.add("selected"); // 선택 시 색상 변경
                } else {
                    tagItem.classList.remove("selected"); // 선택 취소 시 원래 색으로 변경
                }
            });
        });

    }); 
</script>

{% endblock %}
